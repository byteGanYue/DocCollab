# 文档历史版本页面

## 功能说明

文档历史版本页面用于显示和管理指定文档的所有历史版本记录，提供版本查看、对比和恢复功能。

## 页面特性

### 1. 基本功能
- **版本列表展示**：以表格形式展示文档的所有历史版本
- **版本信息**：包括版本号、文档名称、更新人、更新时间等信息
- **当前版本标识**：清楚标识哪个版本是当前正在使用的版本
- **分页支持**：支持大量历史版本的分页浏览

### 2. 交互功能
- **版本详情查看**：点击可查看特定版本的详细信息
- **版本恢复**：可将文档恢复到历史版本（创建新版本）
- **面包屑导航**：提供清晰的导航路径
- **返回编辑器**：快速返回文档编辑页面

### 3. 用户体验
- **响应式设计**：适配桌面端、平板和移动端
- **加载状态**：提供友好的加载和空状态提示
- **确认弹窗**：重要操作（如版本恢复）提供确认机制

## 页面结构

```
/history-version/:id
├── 面包屑导航
│   ├── 首页
│   ├── 返回编辑器
│   └── 历史版本
├── 页面头部
│   ├── 文档标题 - 历史版本
│   ├── 功能说明
│   └── 刷新按钮
├── 版本列表表格
│   ├── 版本号列
│   ├── 文档名称列
│   ├── 更新人列
│   ├── 更新时间列
│   └── 操作列
└── 分页组件
```

## 表格列说明

| 列名 | 说明 | 特性 |
|------|------|------|
| 版本 | 版本号，如 v1.0, v1.1 | 等宽字体显示，当前版本有绿色标签 |
| 文档名称 | 文档的名称 | 显示文档图标，支持长文本省略 |
| 更新人 | 版本更新者的用户名 | 灰色文字显示 |
| 更新时间 | 版本更新的时间 | 智能时间显示（分钟前、小时前等） |
| 操作 | 版本操作菜单 | 包含查看详情、恢复版本等操作 |

## 入口路径

### 1. 菜单入口
在文件夹菜单中，右键点击文档，选择"历史版本记录"

```javascript
// 菜单项配置
{
  key: 'history',
  label: '历史版本记录',
  onClick: () => navigate(`/history-version/${documentId}`)
}
```

### 2. 直接访问
通过URL直接访问：`/history-version/:documentId`

## API 接口

### 1. 获取文档历史版本
```javascript
const response = await documentAPI.getDocumentHistory(documentId);
```

**响应格式：**
```json
{
  "success": true,
  "data": {
    "versions": [
      {
        "versionId": "v1",
        "versionNumber": "1.0",
        "documentName": "文档标题",
        "updatedBy": "用户名",
        "updatedAt": "2024-01-01T00:00:00Z",
        "content": "文档内容",
        "changeDescription": "版本变更说明"
      }
    ],
    "total": 10
  }
}
```

### 2. 恢复文档版本
```javascript
const response = await documentAPI.restoreDocument(documentId, versionId);
```

### 3. 获取特定版本内容
```javascript
const response = await documentAPI.getDocumentVersion(documentId, versionId);
```

## 样式特性

### 1. 主题适配
- 支持系统主题切换
- 使用CSS变量进行颜色管理
- 深色模式兼容

### 2. 响应式设计
- **桌面端**：完整表格显示
- **平板端**：隐藏部分次要列
- **移动端**：只显示核心信息列

### 3. 视觉增强
- 版本号使用渐变色显示
- 当前版本有绿色标签标识
- 悬停效果和过渡动画
- 统一的按钮和图标风格

## 开发注意事项

### 1. API 兼容性
由于后端历史版本API可能尚未完全实现，页面包含了fallback逻辑：
- 如果API返回失败，会显示模拟数据
- 提供友好的错误提示和警告信息

### 2. 权限控制
- 只有文档的创建者或有编辑权限的用户才能访问历史版本
- 版本恢复操作需要编辑权限

### 3. 性能优化
- 分页加载，避免一次性加载大量版本数据
- 使用React.memo优化表格渲染性能
- 合理的缓存策略

## 扩展功能

### 计划中的功能
1. **版本对比**：支持两个版本之间的内容对比
2. **版本标签**：为重要版本添加标签和说明
3. **批量操作**：支持批量删除旧版本
4. **版本统计**：显示版本创建频率等统计信息

### 集成点
- 与文档编辑器的保存机制集成
- 与协同编辑的冲突解决机制集成
- 与文档权限系统集成 