# ç‹æ¢“ç»µç­”è¾©

> [!TIP]
>
> å„ä½å¯¼å¸ˆå¥½ï¼æˆ‘æ˜¯å¹¿ä¸œå·¥ä¸šå¤§å­¦2027å±Šè½¯ä»¶å·¥ç¨‹çš„ç‹æ¢“ç»µã€‚ğŸ˜
>
> æˆ‘å¼€å§‹æ¥è§¦å‰ç«¯æ˜¯åœ¨å¤§ä¸€ä¸‹å­¦æœŸã€‚ä¹‹å‰å‚ä¸è¿‡å¹¿ä¸œæ­¦è­¦åŒ»é™¢çš„æ™ºæ…§ä»“åº“é¡¹ç›®å¼€å‘,ä¸Šå­¦æœŸå°±èŒäºå¹¿ä¸œé•¿æ­£ç§‘æŠ€æœ‰é™å…¬å¸ï¼Œæ‹…ä»»å‰ç«¯å®ä¹ ç”Ÿ,å®ä¹ æœŸé—´å‚ä¸å…¬å¸å†…éƒ¨erpé¡¹ç›®çš„å¼€å‘ã€‚
>
> å¹³æ—¶ä¸ªäººä¼šåœ¨åšå®¢ä¸Šå‘å¸ƒä¸€äº›æ–‡ç« æ¥è®°å½•å­¦ä¹ ï¼Œçƒ­çˆ±å‰ç«¯ã€‚



## 1. æ–‡ä»¶å¤¹å’Œæ–‡æ¡£æ¨¡å—
ç¬¬ä¸€éƒ¨åˆ†æ˜¯æ–‡ä»¶å¤¹å’Œæ–‡æ¡£æ¨¡å—çš„è®¾è®¡ä¸å®ç°,å®ç°äº†æ–‡ä»¶å¤¹ä¸æ–‡æ¡£çš„åˆ›å»ºã€åˆ é™¤ã€é‡å‘½åç­‰åŠŸèƒ½ã€‚
æ”¯æŒç”¨æˆ·æ›´æ”¹æƒé™,æƒé™ä¿®æ”¹ä¸ºå…¬å¼€çš„æ—¶å€™,è¯¥ç”¨æˆ·çš„æ‰€æœ‰æ–‡ä»¶å¤¹ä¸æ–‡æ¡£ä¼šå¼€å‘ä¸ºååŒæ¨¡å¼,å­˜æ”¾åˆ°ååŒç©ºé—´ç›®å½•é‡Œé¢,å…¶ä»–ç”¨æˆ·å¯ä»¥å…±åŒç¼–è¾‘ã€‚

### 1.1 éš¾ç‚¹:
éš¾ç‚¹åœ¨äºå¦‚ä½•æ„å»ºæ–‡ä»¶å¤¹ä¸æ–‡æ¡£ä¹‹é—´ä¹‹é—´çš„åµŒå¥—å…³ç³»ä»¥åŠç›®å½•æ ‘çš„æ„å»ºã€æ–‡æ¡£åˆå§‹åŒ–å”¯ä¸€å‘½åã€‚

#### ç›®å½•æ ‘æ„å»ºç®—æ³•ï¼š
åç«¯é‡‡ç”¨ `buildFolderTree` é€’å½’æŸ¥è¯¢ç®—æ³•ï¼š
1. ä»æ ¹æ–‡ä»¶å¤¹å¼€å§‹ï¼ˆ`parentFolderIds: { $size: 0 }`ï¼‰
2. ä½¿ç”¨ `Promise.all` å¹¶è¡Œé€’å½’æ„å»ºæ¯ä¸ªæ–‡ä»¶å¤¹çš„å­æ ‘
3. è¿”å›å®Œæ•´çš„**æ–‡ä»¶å¤¹**åµŒå¥—æ ‘ç»“æ„

#### å‰ç«¯å¤„ç†æµç¨‹ï¼š
1. é€šè¿‡ `convertBackendFoldersToMenuFormat` å°†æ–‡ä»¶å¤¹æ ‘è½¬æ¢ä¸º Ant Design Menu æ ¼å¼
2. ä½¿ç”¨ `buildFolderDocumentTree` å·¥å…·å‡½æ•°åˆ›å»ºæ–‡ä»¶å¤¹-æ–‡æ¡£æ˜ å°„å…³ç³»
3. å°†æ–‡æ¡£æŒ‰ç…§å…¶ `parentFolderIds` åˆ†é…åˆ°å¯¹åº”çš„æ–‡ä»¶å¤¹èŠ‚ç‚¹ä¸‹

#### 1.1.1 åç«¯æ ‘ç»“æ„æ„å»º

![image-20250708020941957](./image/image-20250708020941957.png)

*å›¾ï¼šåç«¯é€’å½’æ„å»ºæ–‡ä»¶å¤¹æ ‘çš„æµç¨‹ç¤ºæ„å›¾*

**æ ¸å¿ƒæ–¹æ³•ï¼š`buildFolderTree`ï¼ˆé€’å½’æ„å»ºï¼‰**
```javascript
/**
 * åç«¯é€’å½’æ„å»ºæ–‡ä»¶å¤¹æ ‘çš„æ ¸å¿ƒæ–¹æ³•
 * @param parentFolderId - çˆ¶æ–‡ä»¶å¤¹ID
 * @param userId - ç”¨æˆ·ID
 * @param currentDepth - å½“å‰æ·±åº¦
 * @param maxDepth - æœ€å¤§æ·±åº¦é™åˆ¶
 */
private async buildFolderTree(
  parentFolderId: string | null = null,
  userId?: string,
  currentDepth: number = 0,
  maxDepth?: number,
): Promise<FolderTreeResponse> {
  // 1. æ„å»ºæŸ¥è¯¢æ¡ä»¶
  const filter: FilterQuery<Folder> = {};
  
  // æ ¹æ®çˆ¶æ–‡ä»¶å¤¹IDç­›é€‰
  if (parentFolderId) {
    filter.parentFolderIds = parentFolderId;
  } else {
    filter.parentFolderIds = { $size: 0 }; // æŸ¥è¯¢æ ¹ç›®å½•æ–‡ä»¶å¤¹
  }
  
  // 2. æŸ¥è¯¢å½“å‰å±‚çº§çš„æ–‡ä»¶å¤¹
  const folders = await this.folderModel
    .find(filter)
    .sort({ folderName: 1 })
    .lean()
    .exec();
  
  // 3. é€’å½’æ„å»ºå­æ–‡ä»¶å¤¹æ ‘
  const foldersWithChildren = await Promise.all(
    folders.map(async (folder): Promise<FolderTreeItem> => {
      // é€’å½’è°ƒç”¨æ„å»ºå­æ–‡ä»¶å¤¹
      const children = await this.buildFolderTree(
        folder._id.toString(),
        userId,
        currentDepth + 1,
        maxDepth,
      );
      
      // æ„å»ºå®Œæ•´çš„æ ‘èŠ‚ç‚¹
      return {
        folderId: folder._id.toString(),
        autoFolderId: folder.folderId,
        folderName: folder.folderName,
        userId: folder.userId,
        parentFolderIds: folder.parentFolderIds,
        depth: folder.depth,
        childrenCount: {
          documents: folder.all_children_documentId?.length || 0,
          folders: folder.all_children_folderId?.length || 0,
        },
        children: children.data, // é€’å½’çš„å­èŠ‚ç‚¹
        create_time: folder.create_time,
        update_time: folder.update_time,
      };
    }),
  );
  
  return {
    success: true,
    message: `æŸ¥è¯¢æ–‡ä»¶å¤¹æ ‘å½¢ç»“æ„æˆåŠŸ`,
    data: foldersWithChildren,
  };
}
```
#### 1.1.2 æ–‡ä»¶å¤¹-æ–‡æ¡£å…³ç³»æ˜ å°„
**æ ¸å¿ƒæ–¹æ³•**ï¼šbuildFolderDocumentTree

- åˆ›å»º folderDocuments æ˜ å°„è¡¨ï¼ˆæ–‡ä»¶å¤¹ID â†’ æ–‡æ¡£æ•°ç»„ï¼‰

- éå†æ‰€æœ‰æ–‡æ¡£ï¼Œæ ¹æ®å…¶ parentFolderIds åˆ†é…åˆ°å¯¹åº”æ–‡ä»¶å¤¹

- ç‰¹æ®Šå¤„ç†ï¼šæ— çˆ¶æ–‡ä»¶å¤¹çš„æ–‡æ¡£å½’å…¥ ROOT ç±»åˆ«
```javascript
/**
 * æ„å»ºæ–‡ä»¶å¤¹å’Œæ–‡æ¡£çš„å…³ç³»æ˜ å°„
 * @param folders - æ–‡ä»¶å¤¹æ•°ç»„
 * @param documents - æ–‡æ¡£æ•°ç»„
 */
static buildFolderDocumentTree(folders = [], documents = []) {
  // 1. åˆ›å»ºæ–‡ä»¶å¤¹IDæ˜ å°„
  const folderMap = new Map();
  
  // é€’å½’æ”¶é›†æ‰€æœ‰æ–‡ä»¶å¤¹ID
  const collectFolderIds = folderList => {
    folderList.forEach(folder => {
      folderMap.set(folder.folderId, folder);
      if (folder.autoFolderId) {
        folderMap.set(folder.autoFolderId, folder);
      }
      
      // é€’å½’å¤„ç†å­æ–‡ä»¶å¤¹
      if (folder.children && folder.children.length > 0) {
        collectFolderIds(folder.children);
      }
    });
  };
  
  collectFolderIds(folders);
  
  // 2. åˆ›å»ºæ–‡æ¡£åˆ†ç±»æ˜ å°„
  const folderDocuments = new Map();
  
  // æ ¹æ®parentFolderIdså°†æ–‡æ¡£åˆ†é…åˆ°å¯¹åº”çš„æ–‡ä»¶å¤¹
  documents.forEach(doc => {
    const parentIds = doc.parentFolderIds || [];
    
    if (parentIds.length === 0) {
      // æ ¹çº§æ–‡æ¡£
      if (!folderDocuments.has('ROOT')) {
        folderDocuments.set('ROOT', []);
      }
      folderDocuments.get('ROOT').push(doc);
    } else {
      // è·å–ç›´æ¥çˆ¶æ–‡ä»¶å¤¹ID
      const directParentId = parentIds[parentIds.length - 1];
      const parentFolder = folderMap.get(directParentId);
      
      if (parentFolder) {
        const folderId = parentFolder.folderId;
        if (!folderDocuments.has(folderId)) {
          folderDocuments.set(folderId, []);
        }
        folderDocuments.get(folderId).push(doc);
      }
    }
  });
  
  return {
    folderMap,
    folderDocuments,
    rootDocuments: folderDocuments.get('ROOT') || [],
  };
}
```
#### 1.1.3 å‰ç«¯æ ‘ç»“æ„å¤„ç†
**æ ¸å¿ƒæ–¹æ³•**ï¼šconvertBackendFoldersToMenuFormat
è´Ÿè´£é€’å½’éå†æ–‡ä»¶å¤¹æ ‘ï¼Œå¹¶å°†æ¯ä¸ªæ–‡ä»¶å¤¹èŠ‚ç‚¹è½¬æ¢ä¸ºèœå•èŠ‚ç‚¹ï¼ŒåŒæ—¶å°†å¯¹åº”æ–‡ä»¶å¤¹ä¸‹çš„æ–‡æ¡£ä½œä¸ºå­èŠ‚ç‚¹ï¼ˆå¶å­èŠ‚ç‚¹ï¼‰åŠ å…¥
```javascript
/**
 * å°†åç«¯æ–‡ä»¶å¤¹æ•°æ®è½¬æ¢ä¸ºå‰ç«¯èœå•æ ¼å¼
 * @param backendFolders - åç«¯æ–‡ä»¶å¤¹æ•°æ®
 * @param documents - æ–‡æ¡£æ•°æ®
 */
const convertBackendFoldersToMenuFormat = (backendFolders, documents = []) => {
  // 1. ä½¿ç”¨å·¥å…·å‡½æ•°æ„å»ºæ–‡ä»¶å¤¹å’Œæ–‡æ¡£çš„æ˜ å°„å…³ç³»
  const { folderDocuments, rootDocuments } = 
    folderUtils.buildFolderDocumentTree(backendFolders, documents);
  
  // 2. é€’å½’è½¬æ¢åç«¯æ–‡ä»¶å¤¹æ•°æ®ä¸ºå‰ç«¯èœå•æ ¼å¼
  const convertFolderToMenuItem = folder => {
    const menuItem = {
      key: folder.folderId,
      autoFolderId: folder.autoFolderId,
      icon: React.createElement(FolderOpenOutlined),
      label: <EllipsisLabel text={folder.folderName} />,
      children: [],
      backendData: folder,
      depth: folder.depth || 0,
      parentFolderIds: folder.parentFolderIds || [],
      childrenCount: folder.childrenCount || { documents: 0, folders: 0 },
    };
    
    // 3. é€’å½’å¤„ç†å­æ–‡ä»¶å¤¹
    if (folder.children && folder.children.length > 0) {
      menuItem.children = folder.children.map(childFolder =>
        convertFolderToMenuItem(childFolder),
      );
    }
    
    // 4. æ·»åŠ æ–‡æ¡£åˆ°å½“å‰æ–‡ä»¶å¤¹
    const folderDocumentList = folderUtils.getDocumentsByFolderId(
      folderDocuments,
      folder.folderId,
    );
    
    const documentMenuItems = folderDocumentList.map(doc => ({
      key: `doc_${doc.documentId}`,
      label: <EllipsisLabel text={doc.documentName} />,
      isLeaf: true,
      backendData: doc,
      documentId: doc.documentId,
    }));
    
    // 5. åˆå¹¶æ–‡ä»¶å¤¹å’Œæ–‡æ¡£
    menuItem.children = [...(menuItem.children || []), ...documentMenuItems];
    
    return menuItem;
  };
  
  // 6. è½¬æ¢æ‰€æœ‰æ ¹çº§æ–‡ä»¶å¤¹
  const folderTree = backendFolders.map(folder => convertFolderToMenuItem(folder));
  
  return folderTree;
};

```
![image-20250708021007144](./image/image-20250708021007144.png)

*å›¾ï¼šå‰ç«¯æ ‘å¤„ç†æµç¨‹ç¤ºæ„å›¾*

*Ant Design Menuæ ¼å¼*

```javascript
const items = [
  {
    key: '1',
    icon: <MailOutlined />,
    label: 'Navigation One',
    children: [
      { key: '11', label: 'Option 1' },
      { key: '12', label: 'Option 2' },
      { key: '13', label: 'Option 3' },
      { key: '14', label: 'Option 4' },
    ],
  },
  {
    key: '2',
    icon: <AppstoreOutlined />,
    label: 'Navigation Two',
    children: [
      { key: '21', label: 'Option 1' },
      { key: '22', label: 'Option 2' },
      {
        key: '23',
        label: 'Submenu',
        children: [
          { key: '231', label: 'Option 1' },
          { key: '232', label: 'Option 2' },
          { key: '233', label: 'Option 3' },
        ],
      },
      {
        key: '24',
        label: 'Submenu 2',
        children: [
          { key: '241', label: 'Option 1' },
          { key: '242', label: 'Option 2' },
          { key: '243', label: 'Option 3' },
        ],
      },
    ],
  },
  {
    key: '3',
    icon: <SettingOutlined />,
    label: 'Navigation Three',
    children: [
      { key: '31', label: 'Option 1' },
      { key: '32', label: 'Option 2' },
      { key: '33', label: 'Option 3' },
      { key: '34', label: 'Option 4' },
    ],
  },
];
```
### 1.2 æ€»ç»“è¿™ä¸ªæ–¹æ³•æœ‰ä»€ä¹ˆå¥½å¤„ï¼š
![image-20250708021027630](./image/image-20250708021027630.png)

*å›¾ï¼šæ„å»ºæ€»ç»“æµç¨‹å›¾*

#### 1. æˆ‘ä»¬å½“å‰çš„è®¾è®¡æ˜¯å°†æ–‡ä»¶å¤¹æ ‘çš„æ„å»ºå’Œæ–‡æ¡£çš„åˆ†é…åˆ†ç¦»ï¼Œå…·ä½“æ¥è¯´ï¼š 
åç«¯åªè´Ÿè´£æ„å»ºæ–‡ä»¶å¤¹çš„æ ‘å½¢ç»“æ„ï¼ˆé€šè¿‡é€’å½’æŸ¥è¯¢æ–‡ä»¶å¤¹è¡¨ï¼‰ï¼Œå‰ç«¯åœ¨æ‹¿åˆ°æ–‡ä»¶å¤¹æ ‘å’Œæ–‡æ¡£åˆ—è¡¨ï¼ˆå•ç‹¬è¯·æ±‚çš„ï¼‰åï¼Œé€šè¿‡`buildFolderDocumentTree`æ–¹æ³•å°†æ–‡æ¡£åˆ†é…åˆ°å¯¹åº”çš„æ–‡ä»¶å¤¹èŠ‚ç‚¹ï¼ˆåŒ…æ‹¬æ ¹èŠ‚ç‚¹ï¼‰ è€Œå¦ä¸€ç§å¸¸è§çš„åšæ³•æ˜¯ï¼šåœ¨åç«¯æ„å»ºæ ‘çš„æ—¶å€™åŒæ—¶æŸ¥è¯¢æ–‡æ¡£ï¼Œå°†æ–‡æ¡£ä½œä¸ºå¶å­èŠ‚ç‚¹ç›´æ¥æ„å»ºåˆ°æ ‘ä¸­ã€‚ 
#### 2. å½“å‰è®¾è®¡çš„å¥½å¤„ï¼š 
1. *èŒè´£åˆ†ç¦»ï¼Œç»“æ„æ¸…æ™°*ï¼š  
-  æ–‡ä»¶å¤¹æ ‘å’Œæ–‡æ¡£å±äºä¸åŒçš„æ•°æ®ç±»å‹ï¼Œåˆ†å¼€å¤„ç†ä½¿å¾—é€»è¾‘æ›´æ¸…æ™°ã€‚   
-  å°†æ–‡æ¡£å¤„ç†æ”¾åœ¨å‰ç«¯ï¼Œå¯ä»¥é¿å…æ¯æ¬¡æ–‡æ¡£ç»“æ„å˜åŠ¨éƒ½è¦é‡æ–°æ„å»ºæ•´ä¸ªæ ‘ï¼ˆåŒ…æ‹¬æ–‡æ¡£ï¼‰ã€‚
2.  *å‡å°‘åç«¯è®¡ç®—å‹åŠ›*ï¼š
-  å¦‚æœä¸€èµ·æ„å»ºï¼Œåç«¯éœ€è¦åŒæ—¶å¤„ç†æ–‡ä»¶å¤¹å’Œæ–‡æ¡£çš„é€’å½’ï¼Œå°¤å…¶æ˜¯åœ¨æ–‡æ¡£æ•°é‡å¾ˆå¤§çš„æƒ…å†µä¸‹ï¼Œæ„å»ºæ•´ä¸ªæ ‘çš„å¼€é”€ä¼šå¾ˆå¤§ã€‚ 
- å½“å‰è®¾è®¡ä¸‹ï¼Œåç«¯åªå¤„ç†æ–‡ä»¶å¤¹ï¼ˆé€šå¸¸æ•°é‡è¿œå°‘äºæ–‡æ¡£ï¼‰ï¼Œæ–‡æ¡£çš„å¤„ç†æ”¾åœ¨å‰ç«¯ï¼Œåˆ©ç”¨æµè§ˆå™¨çš„è®¡ç®—èƒ½åŠ›ã€‚
3.  *çµæ´»æ€§*ï¼š 
- å‰ç«¯å¯ä»¥ç‹¬ç«‹è·å–æ–‡æ¡£åˆ—è¡¨ï¼ˆä¾‹å¦‚æŒ‰æ¡ä»¶è¿‡æ»¤ï¼‰ï¼Œç„¶åæ ¹æ®éœ€æ±‚åŠ¨æ€åœ°åˆ†é…åˆ°æ–‡ä»¶å¤¹æ ‘ä¸­ã€‚å¦‚æœæ–‡æ¡£åˆ—è¡¨éœ€è¦æ›´æ–°ï¼ˆæ¯”å¦‚ç”¨æˆ·æœç´¢ï¼‰ï¼Œæˆ‘ä»¬åªéœ€è¦é‡æ–°è¿è¡Œ`buildFolderDocumentTree`æ–¹æ³•ï¼Œè€Œä¸éœ€è¦é‡æ–°è¯·æ±‚æ•´ä¸ªæ–‡ä»¶å¤¹æ ‘ã€‚ 
-  å¦‚æœæ–‡æ¡£å’Œæ–‡ä»¶å¤¹æ ‘ä¸€èµ·æ„å»ºï¼Œé‚£ä¹ˆæ¯æ¬¡æ–‡æ¡£æ›´æ–°ï¼ˆæ¯”å¦‚æ–°å¢ä¸€ä¸ªæ–‡æ¡£ï¼‰éƒ½éœ€è¦é‡æ–°æ„å»ºæ•´ä¸ªæ ‘å¹¶è¿”å›ï¼Œè¿™åœ¨æ–‡æ¡£æ•°é‡å¤§æ—¶æ•ˆç‡ä½ä¸‹ã€‚
4. *æ”¯æŒæ–‡æ¡£æ‡’åŠ è½½*ï¼š 
- å½“å‰è®¾è®¡å¯ä»¥è½»æ¾å®ç°æ–‡æ¡£çš„æ‡’åŠ è½½ã€‚ä¾‹å¦‚ï¼Œä¸€å¼€å§‹åªåŠ è½½æ–‡ä»¶å¤¹æ ‘ï¼Œå½“ç”¨æˆ·å±•å¼€æŸä¸ªæ–‡ä»¶å¤¹æ—¶ï¼Œå†å»è¯·æ±‚è¯¥æ–‡ä»¶å¤¹ä¸‹çš„æ–‡æ¡£ï¼Œç„¶ååŠ¨æ€æ·»åŠ åˆ°å·²æœ‰çš„æ ‘ä¸­ã€‚è¿™æ ·å¯ä»¥æ˜¾è‘—æé«˜åˆå§‹åŠ è½½é€Ÿåº¦ã€‚è€Œå¦‚æœä¸€å¼€å§‹å°±æŠŠæ‰€æœ‰æ–‡æ¡£éƒ½æ„å»ºåœ¨æ ‘ä¸­ï¼Œé‚£ä¹ˆåˆå§‹åŠ è½½çš„æ•°æ®é‡ä¼šéå¸¸å¤§ã€‚  

#### 1.3 ç”Ÿæˆå”¯ä¸€é»˜è®¤æ–‡ä»¶å/æ–‡ä»¶å¤¹å


##### 1.3.1 é€»è¾‘æ­¥éª¤
**ï¼ˆ1ï¼‰ æ”¶é›†ç°æœ‰åç§°**ï¼š

- åˆ›å»ºä¸€ä¸ª Set é›†åˆ existingNames å­˜å‚¨æ‰€æœ‰ä¸å¯é‡å¤çš„åç§°ã€‚

- æ·»åŠ é¢å¤–åç§°ï¼šéå† additionalNames å‚æ•°ï¼Œå°†éç©ºåç§°æ·»åŠ åˆ°é›†åˆä¸­ã€‚

- é€’å½’æŸ¥æ‰¾ç›®æ ‡æ–‡ä»¶å¤¹

- å¤„ç†æ ¹ç›®å½•ï¼šè‹¥ targetKey === 'root'ï¼Œç›´æ¥æŸ¥æ‰¾æ ¹èŠ‚ç‚¹ï¼ˆkey='root'ï¼‰çš„å­é¡¹åç§°ã€‚

**ï¼ˆ2ï¼‰ ç”Ÿæˆå”¯ä¸€åç§°**ï¼š

- åˆå§‹åŒ–è®¡æ•°å™¨ counter = 1ï¼Œç”Ÿæˆå€™é€‰åç§° candidateName = baseName + counterã€‚

- å¾ªç¯æ£€æŸ¥ï¼šè‹¥ candidateName åœ¨ existingNames ä¸­å­˜åœ¨ï¼Œåˆ™ counter++ å¹¶ç”Ÿæˆæ–°åç§°ã€‚

- è¿”å›ç»“æœï¼šç›´åˆ°æ‰¾åˆ°ä¸åœ¨é›†åˆä¸­çš„åç§°ï¼Œè¿”å›æœ€ç»ˆçš„ candidateNameã€‚

##### 1.3.2 å…³é”®ä»£ç ï¼š
```javascript
  /**
   * ç”Ÿæˆå”¯ä¸€çš„é»˜è®¤æ–‡ä»¶å/æ–‡ä»¶å¤¹åï¼Œé¿å…åŒçº§ç›®å½•ä¸‹çš„é‡å¤
   * @param {string} baseName - åŸºç¡€åç§°ï¼Œå¦‚"æ–°å»ºæ–‡æ¡£"æˆ–"æ–°å»ºæ–‡ä»¶å¤¹"
   * @param {string} targetKey - ç›®æ ‡æ–‡ä»¶å¤¹çš„key
   * @param {Array} additionalNames - é¢å¤–éœ€è¦æ£€æŸ¥çš„åç§°åˆ—è¡¨ï¼ˆå¦‚åç«¯æœ€æ–°æ•°æ®ï¼‰
   * @returns {string} å”¯ä¸€çš„åç§°
   */
  const generateUniqueDefaultName = (
    baseName,
    targetKey,
    additionalNames = [],
  ) => {
    // è·å–ç›®æ ‡æ–‡ä»¶å¤¹çš„ç°æœ‰å­é¡¹
    const getExistingNames = () => {
      const existingNames = new Set();

      // æ·»åŠ é¢å¤–çš„åç§°åˆ—è¡¨ï¼ˆæ¥è‡ªåç«¯çš„æœ€æ–°æ•°æ®ï¼‰
      additionalNames.forEach(name => {
        if (name) existingNames.add(name);
      });

      // é€’å½’æŸ¥æ‰¾ç›®æ ‡æ–‡ä»¶å¤¹åŠå…¶å­é¡¹
      const findTargetFolderItems = (nodes, key) => {
        for (const node of nodes) {
          if (node.key === key) {
            // æ‰¾åˆ°ç›®æ ‡æ–‡ä»¶å¤¹ï¼Œæ”¶é›†å…¶å­é¡¹åç§°
            if (node.children) {
              node.children.forEach(child => {
                const name = child.label?.props?.text || child.label;
                if (name) {
                  existingNames.add(name);
                }
              });
            }
            return true;
          }
          if (node.children) {
            if (findTargetFolderItems(node.children, key)) {
              return true;
            }
          }
        }
        return false;
      };

      // å¦‚æœæ˜¯æ ¹ç›®å½•
      if (targetKey === 'root') {
        const rootFolder = folderList.find(item => item.key === 'root');
        if (rootFolder && rootFolder.children) {
          rootFolder.children.forEach(child => {
            const name = child.label?.props?.text || child.label;
            if (name) {
              existingNames.add(name);
            }
          });
        }
      } else {
        findTargetFolderItems(folderList, targetKey);
      }

      return existingNames;
    };

    const existingNames = getExistingNames();

    console.log('ç°æœ‰åç§°é›†åˆ:', [...existingNames]);

    // ä»1å¼€å§‹å°è¯•ç”Ÿæˆå”¯ä¸€åç§°
    let counter = 1;
    let candidateName = `${baseName}${counter}`;

    while (existingNames.has(candidateName)) {
      counter++;
      candidateName = `${baseName}${counter}`;
    }

    console.log('ç”Ÿæˆçš„å”¯ä¸€åç§°:', candidateName);
    return candidateName;
  };
```

## 2. slateä¸­ç¼–è¾‘å™¨ä»£ç å—é«˜äº®
ç¬¬äºŒéƒ¨åˆ†æ˜¯å®ç°äº†slateä¸­ç¼–è¾‘å™¨ä»£ç å—é«˜äº®çš„åŠŸèƒ½,ä¸»è¦æ˜¯åŸºäº Slate çš„è£…é¥°å™¨æœºåˆ¶å’Œ Prism.js çš„è¯­æ³•åˆ†æèƒ½åŠ›å»å®ç°çš„ã€‚

![image-20250708021052107](./image/image-20250708021052107.png)

*å›¾ï¼šå‰ç«¯ä»£ç é«˜äº®å¤„ç†æµç¨‹ç¤ºæ„å›¾*
### 2.1 æµç¨‹æ€»ç»“ï¼š
1. ç”¨æˆ·æ“ä½œï¼šç‚¹å‡»ä»£ç å—æŒ‰é’®ï¼Œå°†é€‰ä¸­çš„æ®µè½è½¬æ¢ä¸ºä»£ç å—ç»“æ„
2. è¯­æ³•åˆ†æï¼šä½¿ç”¨Prism.jså¯¹ä»£ç æ–‡æœ¬è¿›è¡Œè¯æ³•åˆ†æï¼Œç”Ÿæˆtokens
3. Tokenæ ‡å‡†åŒ–ï¼šå°†åµŒå¥—çš„tokenç»“æ„å±•å¹³å¹¶æŒ‰è¡Œåˆ†ç»„
4. è£…é¥°å™¨åº”ç”¨ï¼šä¸ºæ¯ä¸ªtokenåˆ›å»ºè£…é¥°ä¿¡æ¯ï¼Œæ ‡è®°ç±»å‹å’Œä½ç½®
5. æ¸²æŸ“è¾“å‡ºï¼šLeafç»„ä»¶å°†è£…é¥°å™¨å±æ€§è½¬æ¢ä¸ºç›¸åº”çš„CSSç±»å
6. æ ·å¼ç”Ÿæ•ˆï¼šé€šè¿‡Prismä¸»é¢˜CSSå®ç°è¯­æ³•é«˜äº®æ•ˆæœ

### 2.2 æ•°æ®ç»“æ„è®¾è®¡
```javascript
// ä»£ç å—å®¹å™¨èŠ‚ç‚¹
{
  type: 'code-block',
  language: 'javascript', // å½“å‰ä»£ç å—ä½¿ç”¨çš„è¯­è¨€
  children: [
    // ä»£ç è¡ŒèŠ‚ç‚¹
    {
      type: 'code-line',
      children: [{ text: 'function test() {' }] // å®é™…ä»£ç æ–‡æœ¬
    },
    {
      type: 'code-line',
      children: [{ text: '  console.log("Hello");' }]
    },
    // ...æ›´å¤šè¡Œ
  ]
}
```
### 2.3 Prism.jsè¯æ³•åˆ†æ
```javascript
// ä»£ç é«˜äº®è£…é¥°å™¨å‡½æ•°
function decorate([node, path]) {
  let decorations = [];
  if (!node || !path) return decorations;
  
  // æ£€æŸ¥æ˜¯å¦ä¸ºä»£ç å—
  if (Element.isElement(node) && node.type === 'code-block') {
    decorations = decorations.concat(decorateCodeBlock([node, path]));
  }
  
  return decorations;
}

// ä¸ºä»£ç å—åº”ç”¨è¯­æ³•é«˜äº®è£…é¥°
const decorateCodeBlock = ([block, blockPath]) => {
  try {
    // 1. æå–ä»£ç æ–‡æœ¬
    const text = block.children.map(line => Node.string(line)).join('\n');
    // 1.å°†ä»£ç å—èŠ‚ç‚¹ï¼ˆblockï¼‰çš„æ‰€æœ‰å­è¡Œï¼ˆchildrenï¼‰æ‹¼æ¥æˆä¸€ä¸ªå®Œæ•´çš„ä»£ç å­—ç¬¦ä¸²ã€‚
    // 2.Node.string(line)ï¼šSlate.jsçš„APIï¼Œç”¨äºæå–èŠ‚ç‚¹ä¸­çš„â€‹â€‹çº¯æ–‡æœ¬å†…å®¹â€‹â€‹ï¼Œå¿½ç•¥æ‰€æœ‰æ ¼å¼ã€æ ‡ç­¾ç­‰éæ–‡æœ¬å…ƒç´ ã€‚
    const language = block.language || 'html';
    
    // 2. æ£€æŸ¥è¯­è¨€æ”¯æŒ
    if (!Prism.languages[language]) {
      return [];
    }
    
    // 3. ä½¿ç”¨Prism.jsè¿›è¡Œè¯æ³•åˆ†æ
    const tokens = Prism.tokenize(text, Prism.languages[language]);
    
    // 4. æ ‡å‡†åŒ–tokensï¼ŒæŒ‰è¡Œåˆ†ç»„
    const normalizedTokens = normalizeTokens(tokens);
    
    // 5. ä¸ºæ¯ä¸ªtokenåˆ›å»ºè£…é¥°ä¿¡æ¯
    const decorations = [];
    for (let index = 0; index < normalizedTokens.length; index++) {
      const tokens = normalizedTokens[index];
      let start = 0;
      
      for (const token of tokens) {
        const length = token.content.length;
        if (!length) continue;
        
        const end = start + length;
        const path = [...blockPath, index, 0]; // å®šä½åˆ°å…·ä½“çš„ä»£ç è¡Œ
        
        // åˆ›å»ºè£…é¥°å¯¹è±¡
        const decoration = {
          anchor: { path, offset: start },
          focus: { path, offset: end },
          token: true,
        };
        
        // ä¸ºæ¯ä¸ªtokenç±»å‹æ·»åŠ æ ‡è®°
        token.types.forEach(type => {
          decoration[type] = true;
        });
        
        decorations.push(decoration);
        start = end;
      }
    }
    
    return decorations;
  } catch (error) {
    console.error('ä»£ç é«˜äº®å¤„ç†å¤±è´¥:', error);
    return [];
  }
};
```
**2.3.1 Tokenæ ‡å‡†åŒ–å¤„ç†**
```javascript
// æ ‡å‡†åŒ–Prism.jsç”Ÿæˆçš„tokens
export const normalizeTokens = tokens => {
  const lines = [[]];
  let currentLine = 0;

  const processToken = (token, types = []) => {
    if (typeof token === 'string') {
      // å¤„ç†çº¯æ–‡æœ¬ï¼ŒæŒ‰æ¢è¡Œç¬¦åˆ†å‰²
      const parts = token.split('\n');
      for (let i = 0; i < parts.length; i++) {
        if (i > 0) {
          // é‡åˆ°æ¢è¡Œç¬¦ï¼Œåˆ›å»ºæ–°è¡Œ
          currentLine++;
          lines[currentLine] = [];
        }
        if (parts[i]) {
          lines[currentLine].push({
            types,
            content: parts[i],
          });
        }
      }
    } else if (typeof token === 'object' && token !== null) {
      // å¤„ç†å¤æ‚çš„tokenå¯¹è±¡
      if (token.content) {
        const newTypes = token.type ? [...types, token.type] : types;
        if (Array.isArray(token.content)) {
          token.content.forEach(subToken => processToken(subToken, newTypes));
        } else {
          processToken(token.content, newTypes);
        }
      }
    }
  };

  tokens.forEach(token => processToken(token));
  
  // ç¡®ä¿æ¯ä¸€è¡Œéƒ½æœ‰å†…å®¹
  return lines.map(line =>
    line.length === 0 ? [{ types: [], content: '' }] : line,
  );
};
```
### 2.4 æ¸²æŸ“å±‚å®ç°
#### 2.4.1 ä»£ç å—å®¹å™¨æ¸²æŸ“
```javascript
// Element.jsx - ä»£ç å—å®¹å™¨æ¸²æŸ“
case 'code-block':
  const setLanguage = language => {
    const path = ReactEditor.findPath(editor, element);
    Transforms.setNodes(editor, { language }, { at: path });
  };

  return (
    <div
      {...attributes}
      style={{
        fontFamily: 'monospace',
        fontSize: '16px',
        lineHeight: '20px',
        background: 'rgba(0, 20, 60, .03)',
        padding: '5px 13px',
        position: 'relative',
        borderRadius: '8px',
        border: '1px solid #e1e5e9',
      }}
      spellCheck={false}
    >
      <LanguageSelect
        value={element.language || 'html'}
        onChange={e => setLanguage(e.target.value)}
      />
      {children}
    </div>
  );
```
#### 2.4.2 å¶å­èŠ‚ç‚¹é«˜äº®æ¸²æŸ“
```javascript

const Leaf = ({ attributes, children, leaf }) => {
  // æå– token ç±»å‹
  const tokenClasses = Object.keys(leaf).filter(
    cls => !['text', 'token'].includes(cls)
  );
  
  if (tokenClasses.length > 0) {
    return (
      <span
        {...attributes}
        className={`token ${tokenClasses.join(' ')}`}
      >
        {children}
      </span>
    );
  }
  
  return <span {...attributes}>{children}</span>;
};
```

### 2.5 æ»¡è¶³ Prism.js çš„è¾“å…¥è¦æ±‚ï¼šPrism.js è¯­æ³•åˆ†æå™¨éœ€è¦å®Œæ•´çš„ä»£ç å­—ç¬¦ä¸²ä½œä¸ºè¾“å…¥
```javascript
const text = block.children.map(line => Node.string(line)).join('\n');
```
#### æ­¥éª¤ 1: block.children.map(...)
- block.children è·å–ä»£ç å—çš„æ‰€æœ‰å­èŠ‚ç‚¹ï¼ˆå³æ‰€æœ‰ä»£ç è¡Œï¼‰
- map() æ–¹æ³•éå†æ¯ä¸ªä»£ç è¡ŒèŠ‚ç‚¹
#### æ­¥éª¤ 2: Node.string(line)
- è¿™æ˜¯ Slate.js æä¾›çš„ API æ–¹æ³•
- ä½œç”¨ï¼šæå–èŠ‚ç‚¹åŠå…¶æ‰€æœ‰å­èŠ‚ç‚¹çš„çº¯æ–‡æœ¬å†…å®¹
- å¯¹äºç®€å•æ–‡æœ¬èŠ‚ç‚¹ï¼Œç›´æ¥è¿”å›æ–‡æœ¬å†…å®¹
- å¯¹äºåŒ…å«æ ¼å¼çš„æ–‡æœ¬ï¼ˆå¦‚ç²—ä½“ã€æ–œä½“ï¼‰ï¼Œåªè¿”å›çº¯æ–‡æœ¬
#### æ­¥éª¤ 3: .join('\n')
- å°†æ¯è¡Œä»£ç çš„æ–‡æœ¬æ•°ç»„è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²
- åœ¨æ¯è¡Œä¹‹é—´æ·»åŠ æ¢è¡Œç¬¦ \n
- ç”Ÿæˆå®Œæ•´çš„ä»£ç å­—ç¬¦ä¸²
#### ç¤ºä¾‹æ¼”ç¤º
- å‡è®¾ç¼–è¾‘å™¨ä¸­æœ‰ä»¥ä¸‹ä»£ç å—ï¼š
```javascript
  function hello() {
      console.log("ä½ å¥½");
  }
```
- åœ¨ Slate ä¸­çš„æ•°æ®ç»“æ„ï¼š
```javascript
{
  type: 'code-block',
  language: 'javascript',
  children: [
    { type: 'code-line', children: [{ text: 'function hello() {' }] },
    { type: 'code-line', children: [{ text: '  console.log("ä½ å¥½");' }] },
    { type: 'code-line', children: [{ text: '}' }] }
  ]
}
```
- ä»£ç æ‰§è¡Œç»“æœï¼š
```javascript
// ç¬¬ä¸€æ­¥ï¼šmap æ“ä½œ
[
  'function hello() {',
  '  console.log("ä½ å¥½");',
  '}'
]

// ç¬¬äºŒæ­¥ï¼šjoin('\n')
`function hello() {
  console.log("ä½ å¥½");
}`
```
### 2.6 è¯æ€§åˆ†æ
```javascript
const tokens = Prism.tokenize(text, Prism.languages[language]);
```
- è¾“å…¥ï¼š
  - text: å®Œæ•´ä»£ç å­—ç¬¦ä¸²
  - Prism.languages[language]: æŒ‡å®šè¯­è¨€çš„è¯­æ³•è§„åˆ™
- è¾“å‡ºï¼šåµŒå¥—çš„ token ç»“æ„ï¼ˆå°šæœªæ ‡å‡†åŒ–ï¼‰
ç¤ºä¾‹ï¼š
å½“é‡åˆ°å¤æ‚è¯­æ³•ç»“æ„æ—¶ï¼ŒPrism.js ä¼šäº§ç”Ÿå¤šå±‚åµŒå¥—ï¼š
1. å¤šå±‚åµŒå¥—ç»“æ„
```javascript
// ç¤ºä¾‹ï¼šæ¨¡æ¿å­—ç¬¦ä¸²
`Hello ${name}!`

// å¯¹åº”çš„åµŒå¥— token
{
  type: "template-string",
  content: [
    "`Hello ",
    {
      type: "interpolation",
      content: [
        {
          type: "punctuation",
          content: "${"
        },
        {
          type: "variable",
          content: "name"
        },
        {
          type: "punctuation",
          content: "}"
        }
      ]
    },
    "!`"
  ]
}
```
2. æ•°ç»„åµŒå¥—
```javascript
// JSX ç¤ºä¾‹
<div className="test">{value}</div>

// å¯¹åº”çš„ token ç»“æ„
[
  {
    type: "tag",
    content: [
      { type: "punctuation", content: "<" },
      { type: "tag", content: "div" },
      { type: "space", content: " " },
      { type: "attr-name", content: "className" },
      { type: "operator", content: "=" },
      { type: "string", content: '"test"' },
      { type: "punctuation", content: ">" }
    ]
  },
  {
    type: "interpolation",
    content: [
      { type: "punctuation", content: "{" },
      { type: "variable", content: "value" },
      { type: "punctuation", content: "}" }
    ]
  },
  {
    type: "tag",
    content: [
      { type: "punctuation", content: "<" },
      { type: "punctuation", content: "/" },
      { type: "tag", content: "div" },
      { type: "punctuation", content: ">" }
    ]
  }
]
```
### 2.7 Token æ ‡å‡†åŒ–å¤„ç†
```javascript
const normalizedTokens = normalizeTokens(tokens);
```
- ç›®çš„ï¼šå°† Prism çš„åµŒå¥— token è½¬æ¢ä¸ºæŒ‰è¡Œåˆ†ç»„çš„æ‰å¹³ç»“æ„
- è¾“å…¥ï¼šPrism åŸå§‹ token æ•°ç»„
- è¾“å‡ºï¼šäºŒç»´æ•°ç»„ lines[][]ï¼Œæ¯è¡ŒåŒ…å«è¯¥è¡Œçš„ tokens
- å…³é”®è½¬æ¢ï¼š
```javascript
//è¾“å…¥ï¼š
function test() {
    return;
}
// è½¬æ¢å‰ï¼ˆPrism åŸå§‹è¾“å‡ºï¼‰
["function", " ", "test()", " ", "{", "\n", "  return;", "\n", "}"]

// è½¬æ¢åï¼ˆæ ‡å‡†åŒ–ï¼‰
[
  [ // è¡Œ1
    { types: ["keyword"], content: "function" },
    { types: [], content: " " },
    { types: ["function"], content: "test()" },
    // ...
  ],
  [ // è¡Œ2
    { types: [], content: "  " },
    { types: ["keyword"], content: "return" },
    // ...
  ]
]
```
## 3. æ‰“åŒ…DocEditorä¸ºä¸€ä¸ªå¼€ç®±å³ç”¨çš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ç»„ä»¶åº“
åŸºäº Vite æ„å»ºäº†ä¸€ä¸ªå¼€ç®±å³ç”¨çš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨Reactç»„ä»¶åº“ DocEditorã€‚æ”¯æŒåŒæ¨¡è¾“å‡ºæ ¼å¼ï¼Œç»“åˆ Rollup çš„å¤–éƒ¨åŒ–é…ç½®ï¼Œå°† Reactã€Slate ç¼–è¾‘å™¨æ ¸å¿ƒå’Œ Ant Design ç­‰é‡é‡çº§ä¾èµ–å®Œå…¨å¤–éƒ¨åŒ–ï¼ˆåœ¨ä½¿ç”¨è¯¥åº“æ—¶éœ€è¦è‡ªè¡Œå®‰è£…è¿™äº›ä¾èµ–ï¼‰å‡å°‘æœ€ç»ˆäº§ç‰©ä½“ç§¯ï¼Œä½¿å¾—è¿™ä¸ªå¯Œæ–‡æœ¬ç¼–è¾‘å™¨èƒ½æ— ç¼é›†æˆåˆ°å…¶ä»–é¡¹ç›®ä¸­ä½œä¸ºç»„ä»¶ä½¿ç”¨ï¼Œä½“ç°äº†ç°ä»£å‰ç«¯å·¥ç¨‹åŒ–çš„æ€æƒ³ã€‚
### 3.1 å…³é”®ä»£ç ï¼š
```javascript
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig({
  // 1. æ’ä»¶é…ç½®
  plugins: [react()],
  
  // 2. æ„å»ºé…ç½®
  build: {
    // 2.1 åº“æ¨¡å¼é…ç½®
    lib: {
      entry: 'src/index.jsx',         // å…¥å£æ–‡ä»¶è·¯å¾„
      name: 'DocEditor',              // åº“çš„å…¨å±€å˜é‡å
      fileName: format => `doc-editor.${format}.js`, // è¾“å‡ºæ–‡ä»¶åæ ¼å¼
      formats: ['es', 'umd'],         // è¾“å‡ºæ ¼å¼ï¼šESæ¨¡å—å’ŒUMD
    },
    
    // 2.2 Rollup é«˜çº§é…ç½®
    rollupOptions: {
      // å¤–éƒ¨åŒ–ä¾èµ– - ä¸æ‰“åŒ…è¿›åº“
      external: [
        'react',
        'react-dom',
        'slate',
        'slate-react',
        '@ant-design/icons',
        'antd',
      ],
      
      // è¾“å‡ºé…ç½®
      output: {
        exports: 'named', // ä½¿ç”¨å‘½åå¯¼å‡º
        // å…¨å±€å˜é‡æ˜ å°„ - ä¸ºUMDæ ¼å¼æä¾›å…¨å±€å˜é‡å
        globals: {
          react: 'React',
          'react-dom': 'ReactDOM',
          slate: 'Slate',
          'slate-react': 'SlateReact',
          '@ant-design/icons': 'AntDesignIcons',
          antd: 'antd',
        },
      },
    },
  },
  
  // 3. å¼€å‘æœåŠ¡å™¨é…ç½®
  server: {
    open: true,   // å¯åŠ¨æ—¶è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨
    port: 5175,   // æŒ‡å®šå¼€å‘æœåŠ¡å™¨ç«¯å£
  },
  
  // 4. è·¯å¾„è§£æé…ç½®
  resolve: {
    alias: {
      '@': '/src', // è·¯å¾„åˆ«å
    },
  },
  
  // 5. ç¯å¢ƒæ¡ä»¶é…ç½®
  ...(process.env.NODE_ENV !== 'production' && {
    build: undefined,    // å¼€å‘ç¯å¢ƒç¦ç”¨æ„å»ºé…ç½®
    root: '.',           // è®¾ç½®é¡¹ç›®æ ¹ç›®å½•
    publicDir: false,    // ç¦ç”¨å…¬å…±ç›®å½•
    appType: 'spa',      // åº”ç”¨ç±»å‹ä¸ºå•é¡µåº”ç”¨
  }),
});
```
## 4.å¿ƒå¾—ä½“ä¼š

åœ¨è¿™æ¬¡é£ä¹¦å‰ç«¯è®­ç»ƒè¥çš„å­¦ä¹ ä¸­ï¼Œæˆ‘æœ‰äº†è·¨è¶Šå¼çš„æˆé•¿ã€‚æˆ‘ä»¬å›¢é˜Ÿæ‰“é€ çš„DocCollabååŒæ–‡æ¡£ç¼–è¾‘ç³»ç»Ÿè¿˜åŸäº†ç±»é£ä¹¦æ–‡æ¡£çš„çœŸå®ä¸šåŠ¡åœºæ™¯ï¼Œè®­ç»ƒè¥åŸ¹å…»æ¨¡å¼è®©æˆ‘ä¸ä»…æŒæ¡äº†æ–‡ä»¶å¤¹æ–‡æ¡£ç®¡ç†ã€CRDTå†²çªè§£å†³ç®—æ³•ã€Slate-YjsååŒç¼–è¾‘æ¡†æ¶ç­‰å‰æ²¿æŠ€æœ¯ï¼Œæ›´åœ¨Gitåä½œè§„èŒƒã€Code Reviewæœºåˆ¶ä¸­åŸ¹å…»äº†å·¥ç¨‹åŒ–åä½œæ„è¯†ã€‚

ä»éœ€æ±‚åˆ†æã€æŠ€æœ¯é€‰å‹ã€æ¶æ„è®¾è®¡åˆ°æœ€ç»ˆå®ç°ï¼Œæ¯ä¸ªç¯èŠ‚éƒ½è®©æˆ‘å¯¹è½¯ä»¶å¼€å‘çš„å®Œæ•´æµç¨‹æœ‰äº†æ›´æ¸…æ™°çš„è®¤è¯†ã€‚ç‰¹åˆ«æ„Ÿè°¢æœ¬æ¬¡è®­ç»ƒè¥ç²¾å¿ƒè®¾è®¡çš„æ¸è¿›å¼æŒ‘æˆ˜ä»»åŠ¡ï¼Œä¸ä»…è®©æˆ‘æŒæ¡äº†ååŒç¼–è¾‘çš„æ ¸å¿ƒæŠ€æœ¯ï¼Œæ›´é‡è¦çš„æ˜¯åŸ¹å…»äº†æˆ‘è§£å†³å¤æ‚å·¥ç¨‹é—®é¢˜çš„æ€ç»´æ–¹å¼,ç›¸ä¿¡è¿™äº›ç»éªŒå°†ä¸ºæˆ‘æœªæ¥çš„èŒä¸šå‘å±•å¥ å®šåšå®åŸºç¡€ã€‚
